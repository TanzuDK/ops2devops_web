<!doctype html><html><head><title>Ops2Devops Workshop documentation</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2022-04-19T07:47:04 UTC"><title>11 Deploy with Service :: Ops2Devops Workshop documentation</title><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link href=/css/nucleus.css rel=stylesheet><link href=/css/font-awesome.min.css rel=stylesheet><link href=/css/featherlight.min.css rel=stylesheet><link href=/css/auto-complete.css rel=stylesheet><link href=/theme-flex/style.css rel=stylesheet><link rel=stylesheet href=/css/bootstrap.min.css><meta name=description content></head><body data-url=/4.k8s/11/><header><div class=logo><p>Tanzu.dk Ops2DevOps Workshop</p></div><div class=burger><a href=javascript:void(0); style=font-size:15px>&#9776;</a></div><nav class=shortcuts><li role><a href=https://github.com/TanzuDK/ops2devops rel=noopener><i class="fa fa-github"></i> <label>TanzuDK/ops2devops</label></a></li><li role><a href=https://github.com/rhjensen79 rel=noopener><i class="fa fa-bullhorn"></i> <label>Credits</label></a></li></nav></header><article><aside><ul class=menu><li data-nav-id=/ class=dd-item><a href=/><i class="fa fa-fw fa-home"></i></a></li><li data-nav-id=https://ops2devops.tanzu.dk/1.connect/ class="dd-item haschildren"><div><a href=/1.connect/>1. Connect</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://ops2devops.tanzu.dk/1.connect/1/ class=dd-item><div><a href=/1.connect/1/>01 Ipadresses
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/1.connect/2/ class=dd-item><div><a href=/1.connect/2/>02 Connect to environment
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/1.connect/3/ class=dd-item><div><a href=/1.connect/3/>03 Understand VScode
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://ops2devops.tanzu.dk/2.git/ class="dd-item haschildren"><div><a href=/2.git/>2. Git</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://ops2devops.tanzu.dk/2.git/1/ class=dd-item><div><a href=/2.git/1/>01 Configure Git
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/2.git/2/ class=dd-item><div><a href=/2.git/2/>02 Create first Git Repository
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/2.git/3/ class=dd-item><div><a href=/2.git/3/>03 Create first Git Changes (CLI)
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/2.git/4/ class=dd-item><div><a href=/2.git/4/>04 Create first Git Changes (GUI)
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/2.git/5/ class=dd-item><div><a href=/2.git/5/>05 Fork Repository
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/2.git/6/ class=dd-item><div><a href=/2.git/6/>06 Clone Repository
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/ class="dd-item haschildren"><div><a href=/3.docker/>3. Docker</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/1/ class=dd-item><div><a href=/3.docker/1/>01 Docker Hub
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/2/ class=dd-item><div><a href=/3.docker/2/>02 Dockerfile
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/3/ class=dd-item><div><a href=/3.docker/3/>03 Build Container
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/4/ class=dd-item><div><a href=/3.docker/4/>04 Run Container
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/5/ class=dd-item><div><a href=/3.docker/5/>05 Make Changes
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/6/ class=dd-item><div><a href=/3.docker/6/>06 See different images
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/7/ class=dd-item><div><a href=/3.docker/7/>07 Docker-Compose
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/8/ class=dd-item><div><a href=/3.docker/8/>08 Run as deamon
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/9/ class=dd-item><div><a href=/3.docker/9/>09 Trubleshoot running container
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/10/ class=dd-item><div><a href=/3.docker/10/>10 Cleanup
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/11/ class=dd-item><div><a href=/3.docker/11/>11 Advanced Docker-Compose
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/12/ class=dd-item><div><a href=/3.docker/12/>12 Data / Volumes
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/3.docker/13/ class=dd-item><div><a href=/3.docker/13/>13 Examine content of a volume
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/ class="dd-item haschildren"><div><a href=/4.k8s/>4. Kubernetes</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/1/ class=dd-item><div><a href=/4.k8s/1/>01 Setup Kubeconfig
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/2/ class=dd-item><div><a href=/4.k8s/2/>02 Kubectl
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/3/ class=dd-item><div><a href=/4.k8s/3/>03 Test connection
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/4/ class=dd-item><div><a href=/4.k8s/4/>04 Create Namespace
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/5/ class=dd-item><div><a href=/4.k8s/5/>05 Deployment.yml
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/6/ class=dd-item><div><a href=/4.k8s/6/>06 Harbor Container registry
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/7/ class=dd-item><div><a href=/4.k8s/7/>07 Deploy first K8S app
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/8/ class=dd-item><div><a href=/4.k8s/8/>08 Enhance deployment.yaml
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/9/ class=dd-item><div><a href=/4.k8s/9/>09 Verify deployments / Pods
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/10/ class=dd-item><div><a href=/4.k8s/10/>10 Add service
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/11/ class=dd-item><div><a href=/4.k8s/11/>11 Deploy with Service
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/4.k8s/12/ class=dd-item><div><a href=/4.k8s/12/>12 Cleanup
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/ class="dd-item haschildren"><div><a href=/5.cicd/>5. CI/CD</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/1/ class=dd-item><div><a href=/5.cicd/1/>01 Actions file
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/2/ class=dd-item><div><a href=/5.cicd/2/>02 Copy actions file
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/3/ class=dd-item><div><a href=/5.cicd/3/>03 See running action
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/4/ class=dd-item><div><a href=/5.cicd/4/>04 Discuss Action concepts
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/5/ class=dd-item><div><a href=/5.cicd/5/>05 Trigger build
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/6/ class=dd-item><div><a href=/5.cicd/6/>06 Prepare Kubeconfig file for CI/CD
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/7/ class=dd-item><div><a href=/5.cicd/7/>07 Github Secrets
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/8/ class=dd-item><div><a href=/5.cicd/8/>08 Change deployment.yml
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/9/ class=dd-item><div><a href=/5.cicd/9/>09 K8S Deployment Action
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://ops2devops.tanzu.dk/5.cicd/10/ class=dd-item><div><a href=/5.cicd/10/>10 Activate Deployment Action
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://ops2devops.tanzu.dk/6.misc/ class=dd-item><div><a href=/6.misc/>6. MISC</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul><section></section></aside><section class=page><div class=nav-select><center>Navigation :
<select onchange="location.href=this.value"><option value=/1.connect/>
1. Connect</option><option value=/2.git/>
2. Git</option><option value=/3.docker/>
3. Docker</option><option value=/4.k8s/>
4. Kubernetes</option><option value=/4.k8s/1/>- 01 Setup Kubeconfig</option><option value=/4.k8s/2/>- 02 Kubectl</option><option value=/4.k8s/3/>- 03 Test connection</option><option value=/4.k8s/4/>- 04 Create Namespace</option><option value=/4.k8s/5/>- 05 Deployment.yml</option><option value=/4.k8s/6/>- 06 Harbor Container registry</option><option value=/4.k8s/7/>- 07 Deploy first K8S app</option><option value=/4.k8s/8/>- 08 Enhance deployment.yaml</option><option value=/4.k8s/9/>- 09 Verify deployments / Pods</option><option value=/4.k8s/10/>- 10 Add service</option><option value=/4.k8s/11/ selected>- 11 Deploy with Service</option><option value=/4.k8s/12/>- 12 Cleanup</option><option value=/5.cicd/>
5. CI/CD</option><option value=/6.misc/>
6. MISC</option></select></center></div><div><div class=searchbox><input data-search-input id=search-by type=text placeholder=Search...></div></div><h1>11 Deploy with Service</h1><p>It&rsquo;s normal to split up Kubernetes configuration files, into more files. To deploy them all, in one command, simply add a <code>.</code> in the end, instead of specifiying a single file. We will use this, to deploy both the deployment, and the service, at the same time.</p><p>Note, if you have already deployed something, running the command again, just updated the deployment, in case there are changes.</p><ul><li>Run <code>kubectl apply -f .</code> to deploy all .yml files in the directory</li><li>You should see each file being created</li></ul><pre tabindex=0><code>deployment.apps/student1-deployment created
service/nginx-service created
</code></pre><ul><li>Run <code>kubectl get all -n studentx</code> to see your deployment and services has been deployed.</li></ul><pre tabindex=0><code>NAME                                      READY   STATUS    RESTARTS   AGE
pod/student1-deployment-9888cf49d-w855n   1/1     Running   0          77s

NAME                    TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
service/nginx-service   NodePort   10.152.183.251   &lt;none&gt;        80:30010/TCP   77s

NAME                                  READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/student1-deployment   1/1     1            1           77s

NAME                                            DESIRED   CURRENT   READY   AGE
replicaset.apps/student1-deployment-9888cf49d   1         1         1       77s
</code></pre><ul><li>Open a browser to the public ip of the K8S server, with the port number you specified earlier <code>http://K8SPublicIp:30010</code> and see your deployment is working, and is exposed to the outside world.</li></ul><div class=chevrons><div id=navigation><a class="nav nav-prev" href=/4.k8s/10/ title="10 Add service"><i class="fa fa-chevron-left"></i><label>10 Add service</label></a>
<a class="nav nav-next" href=/4.k8s/12/ title="12 Cleanup" style=margin-right:0><label>12 Cleanup</label><i class="fa fa-chevron-right"></i></a></div></div></section></article><footer><div class=footline><div class=date><i class="fa fa-calendar"></i> Last update on 06/04/2022</div><div class=github-link><a href=https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/4.K8S/11.md target=blank><i class="fa fa-code-fork"></i>
Improve this page</a></div></div><div><p>For info see <a href=https://tanzu.vmware.com>tanzu.vmware.com</a></p></div></footer><script src=/js/jquery-2.x.min.js></script>
<script type=text/javascript>var baseurl="https://ops2devops.tanzu.dk"</script><script src=/js/clipboard.min.js></script>
<script src=/js/featherlight.min.js></script>
<script type=text/javascript src=/js/lunr.min.js></script>
<script type=text/javascript src=/js/auto-complete.js></script>
<script type=text/javascript src=/js/search.js></script>
<script src=/theme-flex/script.js></script>
<script src=https://ops2devops.tanzu.dk/js/scripts.min.js></script></body></html>